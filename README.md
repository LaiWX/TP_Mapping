# 偏移量图绘制程序

这是一个基于PySide6的偏移量图绘制程序，用于可视化理论多边形和实际多边形的对比。

## 功能特点

- 监听剪贴板变化，自动读取和处理数据
- 同时显示理论多边形和多组实际多边形
- 自动缩放和居中显示所有多边形
- 使用不同颜色区分不同的实际多边形组
- 支持鼠标交互功能：
  - 鼠标左键拖动可平移视图
  - 鼠标滚轮可缩放视图，缩放时保持鼠标位置不变
  - 鼠标悬停在点上时显示点的详细信息
- 界面控制按钮：
  - 放大/缩小按钮
  - 重置视图按钮
  - 显示/隐藏网格按钮
- 绘图参数控制：
  - 设计值缩放：控制理论坐标的缩放系数
  - 偏移量缩放：控制偏移量的缩放系数
  - Shot分离：控制不同Shot多边形的间距

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

1. 运行程序：

```bash
python mapping_visualizer.py
```

2. 确保`seq.csv`文件在程序同一目录下

3. 数据格式要求：
   - 需要复制包含以下列的数据到剪贴板：`GLASS_ID`, `GLASS_END_TIME`, `SITE_NAME`, `X`, `Y`, `PARAM_NAME`, `PARAM_VALUE`
   - `SITE_NAME`是点的序号，在`seq.csv`中定义了对应的多边形编号(Shot)和绘图顺序(Seq)
   - 一行数据代表一个点或一个参数
   - `X`, `Y`是理论坐标
   - `PARAM_NAME`和`PARAM_VALUE`用于存储偏移量数据，目前支持`POS_X1`和`POS_Y1`参数
   - `GLASS_ID`和`GLASS_END_TIME`共同作为实际多边形组的标识

4. 复制数据到剪贴板后，程序会自动处理并更新图形显示

5. 交互操作：
   - 拖动鼠标左键可平移视图
   - 使用鼠标滚轮可放大缩小
   - 将鼠标悬停在点上可查看该点的详细信息
   - 使用界面上的按钮进行放大、缩小和重置视图操作
   - 调整参数控件以改变绘图效果：
     - 设计值缩放：理论坐标将除以(设计值缩放*1000)并取整
     - 偏移量缩放：偏移量将除以偏移量缩放值
     - Shot分离：不同Shot的多边形会按照此参数值在X和Y方向移动

## 数据示例

剪贴板数据示例：
```
GLASS_ID,GLASS_END_TIME,SITE_NAME,X,Y,PARAM_NAME,PARAM_VALUE
G001,20230101,1,100000,100000,,
G001,20230101,1,100000,100000,POS_X1,2.5
G001,20230101,1,100000,100000,POS_Y1,1.8
G001,20230101,2,200000,100000,,
G001,20230101,2,200000,100000,POS_X1,-1.2
G001,20230101,2,200000,100000,POS_Y1,0.5
``` 